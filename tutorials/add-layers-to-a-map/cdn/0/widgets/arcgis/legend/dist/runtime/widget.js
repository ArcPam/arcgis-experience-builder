System.register(["jimu-core","jimu-ui","jimu-arcgis"],(function(e){var n,t,o;return{setters:[function(e){n=e},function(e){t=e},function(e){o=e}],execute:function(){e(function(e){var n={};function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)t.d(o,r,function(n){return e[n]}.bind(null,r));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=483)}({0:function(e,t){e.exports=n},1:function(e,n){e.exports=t},234:function(e,n){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M1.5 11a1.5 1.5 0 110 3 1.5 1.5 0 010-3zm14 1a.5.5 0 110 1h-10a.5.5 0 110-1h10zM3 6v3H0V6h3zm12.5 1a.5.5 0 110 1h-10a.5.5 0 010-1h10zm-14-6L3 4H0l1.5-3zm14 1a.5.5 0 110 1h-10a.5.5 0 010-1h10z" fill="#000" fill-rule="evenodd"></path></svg>'},3:function(e,n){e.exports=o},483:function(e,n,t){"use strict";t.r(n),t.d(n,"LoadStatus",(function(){return u}));var o,r=t(0),i=t(3),c=t(1),a=function(e,n){return Object.defineProperty?Object.defineProperty(e,"raw",{value:n}):e.raw=n,e};function s(e,n){var t,i,s,l,u,d,g,p=c.styleUtils.toCSSStyle({background:n.background});delete p.backgroundColor;var f=n.fontColor||(null===(s=null===(i=null===(t=e.arcgis.widgets.legend.variants)||void 0===t?void 0:t.default)||void 0===i?void 0:i.root)||void 0===s?void 0:s.color),h=(null===(l=n.background)||void 0===l?void 0:l.color)||e.surfaces[1].bg,w=e.surfaces[1].bg;return Object(r.css)(o||(o=a(["\n    overflow: auto;\n    .widget-legend {\n      width: 100%;\n      height: 100%;\n      /*background-color: ",";*/\n      background-color: ",";\n      position: relative;\n      ","\n\n      .esri-legend {\n        background-color: transparent;\n        color: ",";\n        height: 100%;\n      }\n\n      .esri-legend--card {\n        background-color: transparent;\n        color: ",";\n        height: 100%;\n      }\n\n      .esri-legend--card.esri-legend--stacked{\n      /*\n        position: absolute;\n        height: 100%;\n        width: 100%;\n      */\n        flex-direction: column;\n        justify-content: space-between;\n      }\n\n      .esri-legend--card__section {\n        width: 100%;\n        height: unset;\n        margin-bottom: 32px;\n      }\n\n      .esri-legend--card__carousel-indicator-container {\n        order: 1;\n        color: ",";\n      }\n\n      .esri-legend--card__service-caption-container {\n        color: ",";\n      }\n\n      .esri-legend--card.esri-widget{\n        background-color: ",";\n      }\n\n      /* .esri-legend {\n        background-color: ",";\n        color: ","\n      }\n\n      .esri-widget__heading {\n        color: ",";\n      }\n\n      .esri-legend--card.esri-widget{\n        background-color: ",";\n        color: ","\n      }\n\n      .esri-legend--card__section {\n        width: 100%;\n        background-color: ",";\n        color: ","\n      }\n\n      .esri-legend--card__carousel-indicator-container {\n        background-color: ",";\n      }\n\n      .esri-legend--card__service {\n        width: 100%;\n      }\n\n      .esri-legend--card__service-caption-container {\n        background-color: ",";\n        color: ",";\n      } */\n\n      /*\n      .esri-legend--card__carousel-indicator {\n        background-color: ",";\n      }\n      */\n    }\n  "],["\n    overflow: auto;\n    .widget-legend {\n      width: 100%;\n      height: 100%;\n      /*background-color: ",";*/\n      background-color: ",";\n      position: relative;\n      ","\n\n      .esri-legend {\n        background-color: transparent;\n        color: ",";\n        height: 100%;\n      }\n\n      .esri-legend--card {\n        background-color: transparent;\n        color: ",";\n        height: 100%;\n      }\n\n      .esri-legend--card.esri-legend--stacked{\n      /*\n        position: absolute;\n        height: 100%;\n        width: 100%;\n      */\n        flex-direction: column;\n        justify-content: space-between;\n      }\n\n      .esri-legend--card__section {\n        width: 100%;\n        height: unset;\n        margin-bottom: 32px;\n      }\n\n      .esri-legend--card__carousel-indicator-container {\n        order: 1;\n        color: ",";\n      }\n\n      .esri-legend--card__service-caption-container {\n        color: ",";\n      }\n\n      .esri-legend--card.esri-widget{\n        background-color: ",";\n      }\n\n      /* .esri-legend {\n        background-color: ",";\n        color: ","\n      }\n\n      .esri-widget__heading {\n        color: ",";\n      }\n\n      .esri-legend--card.esri-widget{\n        background-color: ",";\n        color: ","\n      }\n\n      .esri-legend--card__section {\n        width: 100%;\n        background-color: ",";\n        color: ","\n      }\n\n      .esri-legend--card__carousel-indicator-container {\n        background-color: ",";\n      }\n\n      .esri-legend--card__service {\n        width: 100%;\n      }\n\n      .esri-legend--card__service-caption-container {\n        background-color: ",";\n        color: ",";\n      } */\n\n      /*\n      .esri-legend--card__carousel-indicator {\n        background-color: ",";\n      }\n      */\n    }\n  "])),null===(g=null===(d=null===(u=e.arcgis.widgets.legend.variants)||void 0===u?void 0:u.card)||void 0===d?void 0:d.root)||void 0===g?void 0:g.bg,h,p,f,f,f,f,w,e.colors.palette.light[100],e.colors.black,e.colors.black,e.colors.palette.light[300],e.colors.black,e.colors.palette.light[100],e.colors.black,e.colors.palette.light[300],e.colors.palette.light[300],e.colors.black,e.colors.palette.dark[900])}var l,u,d="Legend",g=(l=function(e,n){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])})(e,n)},function(e,n){function t(){this.constructor=e}l(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}),p=function(e,n,t,o){return new(t||(t=Promise))((function(r,i){function c(e){try{s(o.next(e))}catch(e){i(e)}}function a(e){try{s(o.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?r(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(c,a)}s((o=o.apply(e,n||[])).next())}))},f=function(e,n){var t,o,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;c;)try{if(t=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,o=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=c.trys,(r=r.length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=n.call(e,c)}catch(e){i=[6,e],o=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},h=t(234);!function(e){e.Pending="Pending",e.Fulfilled="Fulfilled",e.Rejected="Rejected"}(u||(u={}));var w=function(e){function n(n){var t=e.call(this,n)||this;return t.componentDidMount=function(){},t.componentWillUnmount=function(){},t.createWebMapView=function(e,n,o){t.destoryView();var r={map:t.dataSource.map,container:t.refs.mapContainer};t.mapView=new e(r),t.mapView.when((function(){n(t.mapView)}),(function(e){return o(e)}))},t.createSceneView=function(e,n,o){t.destoryView();var r={map:t.dataSource.map,container:t.refs.mapContainer};t.sceneView=new t.SceneView(r),t.sceneView.when((function(){n(t.sceneView)}),(function(e){return o(e)}))},t.loadViewModules=function(e){return p(t,void 0,Promise,(function(){var n=this;return f(this,(function(t){switch(t.label){case 0:return e.type!==i.DataSourceTypes.WebMap?[3,4]:this.MapView?[4,Promise.resolve(this.MapView)]:[3,2];case 1:return[2,t.sent()];case 2:return[4,Object(i.loadArcGISJSAPIModules)(["esri/views/MapView"]).then((function(e){return n.MapView=e[0],n.MapView}))];case 3:return[2,t.sent()];case 4:return e.type===i.DataSourceTypes.WebScene?this.SceneView?[2,Promise.resolve(this.SceneView)]:[2,Object(i.loadArcGISJSAPIModules)(["esri/views/SceneView"]).then((function(e){return n.SceneView=e[0],n.SceneView}))]:[2,Promise.reject()];case 5:return[2]}}))}))},t.destoryLegend=function(){t.legend&&!t.legend.destroyed&&t.legend.destroy()},t.createLegend=function(e){return(t.Legend?Promise.resolve():Object(i.loadArcGISJSAPIModules)(["esri/widgets/Legend"]).then((function(e){t.Legend=e[0]}))).then((function(){var n=document&&document.createElement("div");t.refs.legendContainer.appendChild(n),t.destoryLegend(),t.legend=new t.Legend({view:e,container:n}),t.configLegend()}))},t.configLegend=function(){if(t.legend){var e=t.props.config.showBaseMap;t.legend.style=t.calculateStyle(),t.legend.basemapLegendVisible=e}},t.calculateStyle=function(){var e,n=t.currentWidth||1e5;if(t.legend)if(t.props.config.cardStyle){e={type:"card",layout:"auto"===t.props.config.cardLayout?n<=600?"stack":"side-by-side":t.props.config.cardLayout}}else e="classic";else e="classic";return e},t.onActiveViewChange=function(e){e&&e.view?t.createLegend(e.view).then((function(){t.setState({loadStatus:u.Fulfilled})})).catch((function(e){return console.error(e)})):t.destoryLegend()},t.onDataSourceCreated=function(e){t.dataSource=e,t.createViewByDataSource(e).then((function(e){return t.createLegend(e)})).then((function(){t.setState({loadStatus:u.Fulfilled})})).catch((function(e){return console.error(e)}))},t.onCreateDataSourceFailed=function(e){},t.onResize=function(e){if(t.currentWidth=e,t.legend&&"auto"===t.props.config.cardLayout){var n=t.calculateStyle();t.legend.style=n}},t.state={loadStatus:u.Pending},t}return g(n,e),n.prototype.createViewByDataSource=function(e){return p(this,void 0,void 0,(function(){var n=this;return f(this,(function(t){switch(t.label){case 0:return[4,this.loadViewModules(e).then((function(){return p(n,void 0,void 0,(function(){var n=this;return f(this,(function(t){switch(t.label){case 0:return e.type!==i.DataSourceTypes.WebMap?[3,2]:[4,new Promise((function(e,t){return n.createWebMapView(n.MapView,e,t)}))];case 1:return[2,t.sent()];case 2:return e.type===i.DataSourceTypes.WebScene?[2,new Promise((function(e,t){return n.createSceneView(n.SceneView,e,t)}))]:[2,Promise.reject()];case 3:return[2]}}))}))}))];case 1:return[2,t.sent()]}}))}))},n.prototype.destoryView=function(){this.mapView&&!this.mapView.destroyed&&this.mapView.destroy(),this.sceneView&&!this.sceneView.destroyed&&this.sceneView.destroy()},n.prototype.getDefaultStyleConfig=function(){return{useCustom:!1,background:{color:"",fillType:c.FillType.FILL},fontColor:""}},n.prototype.getStyleConfig=function(){return this.props.config.style&&this.props.config.style.useCustom?this.props.config.style:this.getDefaultStyleConfig()},n.prototype.render=function(){var e,n=this.props.useMapWidgetIds&&this.props.useMapWidgetIds[0],t=this.props.useDataSources&&this.props.useDataSources[0],o=null,a=null;if(n?a=Object(r.jsx)(i.JimuMapViewComponent,{useMapWidgetId:null===(e=this.props.useMapWidgetIds)||void 0===e?void 0:e[0],onActiveViewChange:this.onActiveViewChange}):t&&(a=Object(r.jsx)(r.DataSourceComponent,{useDataSource:t,onDataSourceCreated:this.onDataSourceCreated,onCreateDataSourceFailed:this.onCreateDataSourceFailed})),n||t){var l=null;this.state.loadStatus===u.Pending&&(l=Object(r.jsx)("div",{style:{position:"absolute",left:"50%",top:"50%"},className:"jimu-secondary-loading"})),window.jimuConfig.isInBuilder&&this.configLegend(),o=Object(r.jsx)("div",{className:"widget-legend"},l,Object(r.jsx)("div",{ref:"legendContainer",style:{height:"100%"}}),Object(r.jsx)("div",{style:{position:"absolute",display:"none"},ref:"mapContainer"},"mapContainer"),Object(r.jsx)("div",{style:{position:"absolute",display:"none"}},a),Object(r.jsx)(r.ReactResizeDetector,{handleHeight:!0,handleWidth:!0,onResize:this.onResize}))}else this.destoryLegend(),o=Object(r.jsx)("div",{className:"widget-legend"},Object(r.jsx)(c.WidgetPlaceholder,{icon:h,autoFlip:!0,message:this.props.intl.formatMessage({id:"_widgetLabel",defaultMessage:d}),widgetId:this.props.id}));return Object(r.jsx)("div",{css:s(this.props.theme,this.getStyleConfig()),className:"jimu-widget"},o)},n}(r.React.PureComponent);n.default=w}}))}}}));